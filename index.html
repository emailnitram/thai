<!doctype html>
<html ng-app="wordGame">
  <head>
    <meta name="viewport" content="minimal-ui">
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=10.0; user-scalable=1;" />
    <script src="bower_components/hammerjs/hammer.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.4/angular.min.js"></script>
    <script src="bower_components/angular-animate/angular-animate.min.js"></script>
    <script src="bower_components/angular-aria/angular-aria.min.js"></script>
    <script src="bower_components/angular-material/angular-material.min.js"></script>
    <link rel="stylesheet" type="text/css" href="bower_components/angular-material/angular-material.css">
    <style type="text/css" media="screen">
      .main {
        padding: 10px;
      }
      .success {
        color: green;
      }
      input {
        width: 100%;
      }
      h1, h4, p {
        margin-bottom: 2px;
        margin-top: 2px;
        margin-left: 5px;
      }
      p {
        font-size: 12px;
      }
      #guessWord {
        margin-bottom: 10px;
      }
    </style>
    <script>
    angular.module('wordGame',['ngMaterial'])
    .factory('wordsService', ['$http', '$q', function($http, $q) {
      return {
        getWords: function(){
          var deferred = $q.defer();
          $http.get('starredwords.json').success(function(data) {
            deferred.resolve(data);
          });
          return deferred.promise;
        }
      };
    }])
    .controller('mainController', ['$scope','$window', 'wordsService', function($scope, $window, wordsService) {
      var secretWords = [],
          currentSelection;

      wordsService.getWords().then(function(data){
        secretWords = data.results.collection1;
        currentSelection = Math.round(Math.random() * secretWords.length);
        $scope.secretWord = secretWords[currentSelection].word.text;
        $scope.meaning = secretWords[currentSelection].meaning;
        $scope.transliteration = secretWords[currentSelection].transliteration;
        $scope.word = '';
      });

      $scope.nextWord = function() {
        currentSelection = Math.round(Math.random() * secretWords.length);
        $scope.secretWord = secretWords[currentSelection].word.text;
        $scope.meaning = secretWords[currentSelection].meaning;
        $scope.transliteration = secretWords[currentSelection].transliteration;
        $scope.word = '';
        document.getElementById("guessWord").focus();
        $window.scrollTo(0,0);
      };
    }]);
    </script>
  </head>
  <body>
    <div ng-controller="mainController" class="main" layout-sm="row" layout-align="center start">
      <div layout="row" layout-sm="column" layout-align="space-around" ng-show="secretWord === undefined">
        <md-progress-circular mode="indeterminate"></md-progress-circular>
      </div>
      <h1 ng-class="{'success' : secretWord === word}">{{secretWord}}</h1>
      <h4>{{transliteration}}</h4>
      <p>{{meaning}}</p>
      <hr>
      <form ng-submit="secretWord === word && nextWord();">
        <!-- <input id="guessWord" type="text" ng-model="word" placeholder="Go!" autofocus> -->
        <md-text-float id="guessWord" label="Word" ng-model="word"> </md-text-float>
         <md-button class="md-raised" type="submit" name="next" ng-show="secretWord === word" layout="row">Next Word</md-button>
        <!-- <button type="submit" name="next" ng-show="secretWord === word">Next Word</button> -->
      </form>
    </div>
  </body>
</html>
